{% extends 'base.html' %}
{% load static %}
{% block title %}10*10 | India's Real Estate Marketplace{% endblock %}
{% block content %}

<!-- Hero -->
<section class="hero" id="hero">
    <!-- Floating blobs -->
    <div class="blob blob-1"></div>
    <div class="blob blob-2"></div>
    <div class="blob blob-3"></div>
    <div class="hero-overlay"></div>

    <div class="container hero-body text-center text-white">
        <p class="hero-sub mb-2 anim-fade-up" style="animation-delay:.1s">
            üè† India's #1 Real Estate Marketplace
        </p>
        <h1 class="hero-title anim-fade-up" style="animation-delay:.25s">
            Find Your <span class="text-warning hero-typewriter" id="typewriterText">Dream Property</span>
        </h1>
        <p class="hero-desc mb-4 anim-fade-up" style="animation-delay:.4s">
            Browse thousands of listings across India ‚Äî homes, flats, villas, and more.
        </p>

        <!-- Hero Search Bar -->
        <form action="{% url 'search' %}" method="GET" class="hero-search mx-auto anim-fade-up"
            style="animation-delay:.55s">
            <div class="row g-2">
                <div class="col-md-4">
                    <input type="text" name="keywords" class="form-control" placeholder="Keywords..." />
                </div>
                <div class="col-md-3">
                    <input type="text" name="city" class="form-control" placeholder="City" />
                </div>
                <div class="col-md-3">
                    <select name="state" class="form-control">
                        <option value="">Any State</option>
                        <option>Maharashtra</option>
                        <option>Karnataka</option>
                        <option>Delhi</option>
                        <option>Tamil Nadu</option>
                        <option>Gujarat</option>
                        <option>Telangana</option>
                        <option>Kerala</option>
                        <option>Rajasthan</option>
                        <option>West Bengal</option>
                    </select>
                </div>
                <div class="col-md-2">
                    <button class="btn btn-warning w-100 fw-600 hero-search-btn">
                        <i class="fas fa-search me-1"></i>Go
                    </button>
                </div>
            </div>
        </form>

        <!-- Hero Stats -->
        <div class="hero-stats mt-4 d-flex justify-content-center gap-4 flex-wrap anim-fade-up"
            style="animation-delay:.7s">
            <div>
                <span class="fw-700 fs-3 text-warning stat-num" data-target="{{ for_sale_count }}">0</span>
                &nbsp;For Sale
            </div>
            <div class="stat-div"></div>
            <div>
                <span class="fw-700 fs-3 text-warning stat-num" data-target="{{ for_rent_count }}">0</span>
                &nbsp;For Rent
            </div>
            <div class="stat-div"></div>
            <div>
                <span class="stat-num fw-700 fs-3" data-target="95">0</span>% Satisfied
            </div>
        </div>

        <!-- Quick action pills -->
        <div class="hero-pills mt-4 anim-fade-up" style="animation-delay:.85s">
            <a href="/listings/?type=sale" class="hero-pill sale">
                <i class="fas fa-home me-1"></i>For Sale
            </a>
            <a href="/listings/?type=rent" class="hero-pill rent">
                <i class="fas fa-key me-1"></i>For Rent
            </a>
            <a href="/search/?property_type=villa" class="hero-pill">
                <i class="fas fa-landmark me-1"></i>Villas
            </a>
            <a href="/search/?property_type=land" class="hero-pill">
                <i class="fas fa-mountain me-1"></i>Land
            </a>
        </div>
    </div>

    <!-- Scroll indicator -->
    <div class="scroll-hint anim-fade-up" style="animation-delay:1.1s">
        <div class="scroll-dot"></div>
    </div>
</section>

<!-- Featured Listings -->
<section class="py-5">
    <div class="container">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2 class="fw-700 mb-0 reveal">Featured <span class="text-warning">Listings</span></h2>
            <a href="{% url 'listings' %}" class="btn btn-outline-warning btn-sm reveal">View All ‚Üí</a>
        </div>
        {% if listings %}
        <div class="row g-4">
            {% for l in listings %}
            <div class="col-lg-4 col-md-6 reveal" style="transition-delay:{{ forloop.counter0 }}00ms">
                <div class="prop-card h-100 tilt-card">
                    <div class="prop-img-wrap">
                        {% if l.photo_main %}
                        <img src="{{ l.photo_main.url }}" class="prop-img" alt="{{ l.title }}" />
                        {% else %}
                        <div class="prop-img-ph"><i class="fas fa-home fa-2x opacity-25"></i></div>
                        {% endif %}
                        {% if l.listing_type == 'rent' %}
                        <span class="prop-badge badge-rent"><i class="fas fa-key me-1"></i>For Rent</span>
                        {% else %}
                        <span class="prop-badge badge-sale"><i class="fas fa-home me-1"></i>For Sale</span>
                        {% endif %}
                    </div>
                    <div class="prop-body">
                        <div class="d-flex gap-2 mb-2">
                            <span class="ptype-chip">{{ l.get_property_type_display }}</span>
                        </div>
                        <p class="prop-price mb-1">
                            {{ l.price_inr }}
                            {% if l.listing_type == 'rent' %}
                            <span class="small text-muted">/mo</span>
                            {% endif %}
                        </p>
                        <h6 class="fw-700 mb-1">
                            <a href="{% url 'listing' l.pk %}" class="text-white text-decoration-none">{{ l.title }}</a>
                        </h6>
                        <p class="text-muted small mb-2">
                            <i class="fas fa-map-marker-alt me-1 text-warning"></i>{{ l.city }}, {{ l.state }}
                        </p>
                        <div class="prop-feats">
                            {% if l.bedrooms %}<span><i class="fas fa-bed"></i> {{ l.bedrooms }}</span>{% endif %}
                            {% if l.bathrooms %}<span><i class="fas fa-bath"></i> {{ l.bathrooms }}</span>{% endif %}
                            {% if l.sqft %}<span><i class="fas fa-expand-arrows-alt"></i> {{ l.sqft }} sqft</span>{% endif %}

                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <p class="text-muted text-center py-5">No listings yet ‚Äî check back soon!</p>
        {% endif %}
    </div>
</section>

<!-- Why Us -->
<section class="why-us py-5">
    <div class="container text-center">
        <h2 class="fw-700 mb-4 reveal">Why <span class="text-warning">10*10?</span></h2>
        <div class="row g-4">
            <div class="col-md-3 reveal" style="transition-delay:0ms">
                <div class="why-card">
                    <div class="why-icon"><i class="fas fa-search"></i></div>
                    <h6 class="fw-700 mt-3">Smart Search</h6>
                    <p class="small text-muted mb-0">Filter by city, price, bedrooms &amp; more</p>
                </div>
            </div>
            <div class="col-md-3 reveal" style="transition-delay:100ms">
                <div class="why-card">
                    <div class="why-icon"><i class="fas fa-shield-alt"></i></div>
                    <h6 class="fw-700 mt-3">Verified</h6>
                    <p class="small text-muted mb-0">Every listing carefully reviewed</p>
                </div>
            </div>
            <div class="col-md-3 reveal" style="transition-delay:200ms">
                <div class="why-card">
                    <div class="why-icon"><i class="fas fa-comments"></i></div>
                    <h6 class="fw-700 mt-3">Direct Contact</h6>
                    <p class="small text-muted mb-0">Talk to sellers, no middlemen</p>
                </div>
            </div>
            <div class="col-md-3 reveal" style="transition-delay:300ms">
                <div class="why-card">
                    <div class="why-icon"><i class="fas fa-code"></i></div>
                    <h6 class="fw-700 mt-3">Open API</h6>
                    <p class="small text-muted mb-0">Consume data via our REST API</p>
                </div>
            </div>
        </div>
    </div>
</section>

{% if realtors %}
<section class="py-5 bg-light">
    <div class="container">
        <h2 class="fw-700 text-center mb-4 reveal">Our <span class="text-warning">Realtors</span></h2>
        <div class="row g-4 justify-content-center">
            {% for r in realtors %}
            <div class="col-md-4 text-center reveal" style="transition-delay:{{ forloop.counter0 }}00ms">
                <div class="realtor-card p-4">
                    {% if r.photo %}<img src="{{ r.photo.url }}" class="realtor-photo mb-3" alt="{{ r.name }}" />
                    {% else %}<div class="realtor-ph mb-3"><i class="fas fa-user-tie fa-2x"></i></div>{% endif %}
                    {% if r.is_mvp %}<span class="badge bg-warning text-dark mb-2">‚≠ê MVP</span>{% endif %}
                    <h6 class="fw-700">{{ r.name }}</h6>
                    <p class="small text-muted">{{ r.description|truncatechars:80 }}</p>
                    <a href="tel:{{ r.phone }}" class="small text-warning">{{ r.phone }}</a>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>
{% endif %}

<!-- CTA -->
<section class="cta-section text-center py-5 reveal">
    <h2 class="fw-700 text-white mb-3">Ready to find your dream home?</h2>
    <p class="text-white-50 mb-4">Browse listings or post your own property ‚Äî it's free and easy.</p>
    <a href="{% url 'listings' %}" class="btn btn-warning btn-lg px-4 fw-600 me-2 mb-2 btn-shimmer">
        Browse Listings
    </a>
    <a href="/post-listing/" class="btn btn-outline-warning btn-lg px-4 fw-600 me-2 mb-2">
        <i class="fas fa-plus me-1"></i>Post Property
    </a>
    <a href="{% url 'register' %}" class="btn btn-outline-light btn-lg px-4 fw-600 mb-2">Register Free</a>
</section>

{% endblock %}

{% block extra_scripts %}
<script>
    // ‚îÄ‚îÄ Typewriter ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    const words = ['Dream Property', 'Perfect Home', 'Ideal Investment', 'Next Chapter'];
    let wi = 0, ci = 0, deleting = false;
    const el = document.getElementById('typewriterText');

    function type() {
        const word = words[wi];
        if (!deleting) {
            el.textContent = word.slice(0, ci + 1);
            ci++;
            if (ci === word.length) { deleting = true; setTimeout(type, 1600); return; }
        } else {
            el.textContent = word.slice(0, ci - 1);
            ci--;
            if (ci === 0) { deleting = false; wi = (wi + 1) % words.length; }
        }
        setTimeout(type, deleting ? 50 : 90);
    }
    if (el) setTimeout(type, 1200);

    // ‚îÄ‚îÄ Scroll reveal ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    const revealEls = document.querySelectorAll('.reveal');
    const revealObs = new IntersectionObserver((entries) => {
        entries.forEach(e => {
            if (e.isIntersecting) { e.target.classList.add('visible'); }
        });
    }, { threshold: 0.12 });
    revealEls.forEach(el => revealObs.observe(el));

    // ‚îÄ‚îÄ 3D Card tilt ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    document.querySelectorAll('.tilt-card').forEach(card => {
        card.addEventListener('mousemove', e => {
            const r = card.getBoundingClientRect();
            const x = e.clientX - r.left - r.width / 2;
            const y = e.clientY - r.top - r.height / 2;
            card.style.transform = `perspective(600px) rotateY(${x / 25}deg) rotateX(${-y / 25}deg) translateY(-6px)`;
        });
        card.addEventListener('mouseleave', () => {
            card.style.transform = '';
        });
    });

    // ‚îÄ‚îÄ Stat counters (for page load) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    document.querySelectorAll('.stat-num').forEach(el => {
        const target = +el.dataset.target;
        if (!target) return;
        let n = 0;
        const step = Math.max(1, Math.ceil(target / 60));
        const t = setInterval(() => {
            n = Math.min(n + step, target);
            el.textContent = n.toLocaleString();
            if (n >= target) clearInterval(t);
        }, 20);
    });

    // ‚îÄ‚îÄ Why-us icon bounce on hover ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    document.querySelectorAll('.why-icon').forEach(icon => {
        icon.closest('.why-card').addEventListener('mouseenter', () => {
            icon.classList.add('icon-bounce');
        });
        icon.closest('.why-card').addEventListener('animationend', () => {
            icon.classList.remove('icon-bounce');
        });
    });
</script>
{% endblock %}